# Max: An Explainable Sarcastic Response Generator

This repository contains the implementation of the Max sarcasm generator, mentioned in the following papers:
* Silviu Oprea, Steven Wilson, and Walid Magdy. 2021. Chandler: An Explainable Sarcastic Response Generator. In Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing: System Demonstrations, pages 339–349. Association for Computational Linguistics. [link](https://aclanthology.org/2021.emnlp-demo.38/).
* Silviu Vlad Oprea, Steven Wilson, and Walid Magdy. 2022. Should a Chatbot be Sarcastic? Understanding User Preferences Towards Sarcasm Generation. In Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), pages 7686–7700. Association for Computational Linguistics. [link](https://aclanthology.org/2022.acl-long.530/).

## Background

Previous sarcasm generators assume the intended meaning that sarcasm conceals is the opposite of the literal meaning. We argue that this traditional theory of sarcasm provides a grounding that is neither necessary, nor sufficient, for sarcasm to occur. Instead, we ground our generation process on a formal theory that specifies conditions that unambiguously differentiate sarcasm from non-sarcasm. Furthermore, Max not only generates sarcastic responses, but also explanations for why each response is sarcastic. This provides accountability, crucial for avoiding miscommunication between humans and conversational agents, particularly considering that sarcastic communication can be offensive. In human evaluation, Max achieves comparable or higher sarcasm scores, compared to state-of-the-art generators, while generating more diverse responses, that are more specific and more coherent to the input.

Please see [this video](https://aclanthology.org/2021.emnlp-demo.38.mp4) that introduces Max (first paper above; Max named Chandler in the video)
and also [this video](https://aclanthology.org/2022.acl-long.530.mp4) that shows a social study on how users react to sarcastic responses generated by Max (second paper above).

## Running Max

### Environment setup

Clone this repository:

```bash
git clone git@github.com:silviu-oprea/sarcasm-generation.git
```

Max uses COMET ([Bosselut et al., 2019](https://aclanthology.org/P19-1470/)), a language model fine-tuned to complete commonsense relations. We first need to fetch the COMET codebase as follows:

```bash

```

Setup atomic:
- Clone repository: git clone https://github.com/atcbosselut/comet-commonsense.git
- Run download scripts from repo:
  - bash scripts/setup/get_atomic_data.sh
  - bash scripts/setup/get_model_files.sh

pip install ftfy==5.1
python -m spacy download en
python -m spacy download en_core_web_sm

python scripts/data/make_atomic_data_loader.py
Download https://drive.google.com/open?id=1FccEsYPUHnjzmX-Y5vjCBeyRt1pLo8FB
  and unzip to comet-root/pretrained_models
### Sarcastic response generation


## Software workflow

The entry point is main.generate_sarcastic_response(event). It takes as input an
event, i.e. a reference to an action performed by an actor, such as "Ben won the
marathon".

To produce a sarcastic comment, the following happens:

1. Compute expectation;
2. Compute prior and posterior objects;
3. Choose a failure strategy and embed pragmatic insincerity;
4. Generate sarcastic comment.

### Compute expectation

Different strategies for computing the expectation, given the input event,
are implemented under /expectation_extractors.

In the current implementation, the expectation is the negation of the input
event. For instance, if the input is P="Ben won the marathon" the expectation
can be one of E="Ben lost the marathon" or E="Ben was 2nd in the marathon".
